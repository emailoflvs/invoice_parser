# ‚úÖ –•–∞—Ä–¥–∫–æ–¥ —É–¥–∞–ª–µ–Ω –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã

–í—Å–µ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (.env).

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞

### 1. ‚úÖ –õ–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞ (50MB)

**–ë—ã–ª–æ:**
```python
max_size = 50 * 1024 * 1024
```

**–°—Ç–∞–ª–æ:**
```python
max_size = self.config.max_file_size_mb * 1024 * 1024
```

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ config.py:**
```python
max_file_size_mb: int = Field(alias="MAX_FILE_SIZE_MB", default=50)
```

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ env.example:**
```env
MAX_FILE_SIZE_MB=50
```

---

### 2. ‚úÖ –•–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π –ø—É—Ç—å `/app/src`

**–ë—ã–ª–æ:**
```python
reload_dirs=["/app/src"],
```

**–°—Ç–∞–ª–æ:**
```python
if self.config.reload_dirs:
    reload_dirs = [d.strip() for d in self.config.reload_dirs.split(",") if d.strip()]
else:
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—É—Ç—å –∫ src
    src_path = Path(__file__).parent.parent.parent.parent / "src"
    reload_dirs = [str(src_path.resolve())]
```

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ config.py:**
```python
reload_dirs: str = Field(alias="RELOAD_DIRS", default="")
```

**–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ env.example:**
```env
RELOAD_DIRS=  # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è auto-reload —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–ø—É—Å—Ç–æ = –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

**–õ–æ–≥–∏–∫–∞:**
- –ï—Å–ª–∏ `RELOAD_DIRS` –ø—É—Å—Ç–æ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—É—Ç—å –∫ `src/`
- –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —É–∫–∞–∑–∞–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
- –†–∞–±–æ—Ç–∞–µ—Ç –∏ –≤ Docker, –∏ –ª–æ–∫–∞–ª—å–Ω–æ

---

### 3. ‚úÖ –°—Ç—Ä–æ–∫–∞ "Bearer " —Å –º–∞–≥–∏—á–µ—Å–∫–∏–º —á–∏—Å–ª–æ–º

**–ë—ã–ª–æ:**
```python
if token.startswith("Bearer "):
    token = token[7:]
```

**–°—Ç–∞–ª–æ:**
```python
# –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞
BEARER_PREFIX = "Bearer "

# –í –º–µ—Ç–æ–¥–µ
if token.startswith(BEARER_PREFIX):
    token = token[len(BEARER_PREFIX):]
```

**–£–ª—É—á—à–µ–Ω–∏–µ:**
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —è–≤–Ω–æ
- –ù–µ—Ç –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ —á–∏—Å–ª–∞ `7`
- –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —Ç–æ–∫–µ–Ω–∞

---

### 4. ‚úÖ –î–µ—Ñ–æ–ª—Ç max_tokens=16384

**–ë—ã–ª–æ:**
```python
def parse_with_prompt_file(
    ...
    max_tokens: int = 16384,
    ...
):
```

**–°—Ç–∞–ª–æ:**
```python
def parse_with_prompt_file(
    ...
    max_tokens: Optional[int] = None,  # –ï—Å–ª–∏ None - –∏–∑ config
    ...
):
```

**–õ–æ–≥–∏–∫–∞:**
- –ï—Å–ª–∏ `max_tokens=None` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `config.image_max_output_tokens`
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏ –≤—ã–∑–æ–≤–µ
- –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–æ–≥–æ –¥–µ—Ñ–æ–ª—Ç–∞

---

### 5. ‚úÖ –•–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ –ª–æ–≥–µ

**–ë—ã–ª–æ:**
```python
logger.info(f"DETAILED mode: 2 parallel requests with gemini-2.5-pro, total time: {total_elapsed:.2f}s")
```

**–°—Ç–∞–ª–æ:**
```python
logger.info(f"DETAILED mode: 2 parallel requests with {self.config.gemini_model}, total time: {total_elapsed:.2f}s")
```

**–£–ª—É—á—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ config
- –õ–æ–≥ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª–µ–Ω, –¥–∞–∂–µ –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –∏–∑–º–µ–Ω–∏—Ç—Å—è

---

## üìã –ù–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ .env

–î–æ–±–∞–≤–ª–µ–Ω—ã –≤ `env.example`:

```env
# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Web API
MAX_FILE_SIZE_MB=50  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ú–ë
RELOAD_DIRS=  # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è auto-reload —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–ø—É—Å—Ç–æ = –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

–í—Å–µ —Ö–∞—Ä–¥–∫–æ–¥—ã —É–¥–∞–ª–µ–Ω—ã:

```bash
$ grep -rn "50 \* 1024\|50MB\|16384\|gemini-2\.5-pro\|/app/src" src/
‚úÖ No hardcoded values found
```

---

## üéØ –ò—Ç–æ–≥

- ‚úÖ **5 –º–µ—Å—Ç —Å —Ö–∞—Ä–¥–∫–æ–¥–æ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**
- ‚úÖ **–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ .env**
- ‚úÖ **–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏** (Docker, –ª–æ–∫–∞–ª—å–Ω–æ)
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–∏–±–∫–∞—è –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è**

–í—Å–µ –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `.env` —Ñ–∞–π–ª! üöÄ

