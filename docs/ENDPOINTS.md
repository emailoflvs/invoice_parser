# –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã API

## –ß—Ç–æ —Ç–∞–∫–æ–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç?

**–≠–Ω–¥–ø–æ–∏–Ω—Ç** (endpoint) - —ç—Ç–æ URL-–∞–¥—Ä–µ—Å, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –º–æ–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ API –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è.

–ù–∞–ø—Ä–∏–º–µ—Ä:
- `GET /health` - –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
- `POST /api/auth/login` - –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É
- `GET /api/auth/me` - –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

## –í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤ –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

### üåê –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

–≠—Ç–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É.

#### 1. Health Check
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/health`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
  ```bash
  curl http://localhost:8000/health
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
  ```json
  {
    "status": "ok",
    "version": "1.0.0",
    "database": "ok"
  }
  ```

#### 2. –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± API
- **–ü—Ä–∏–º–µ—Ä**: –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ http://localhost:8000

#### 3. API –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/docs`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger UI)
- **–ü—Ä–∏–º–µ—Ä**: –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ http://localhost:8000/docs

#### 4. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/redoc`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (ReDoc)

#### 5. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–ú–µ—Ç–æ–¥**: `POST`
- **URL**: `/api/auth/register`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "username": "newuser",
    "password": "password123",
    "email": "user@example.com"
  }
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
  ```json
  {
    "success": true,
    "message": "User registered successfully",
    "user_id": 1,
    "username": "newuser"
  }
  ```

#### 6. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- **–ú–µ—Ç–æ–¥**: `POST`
- **URL**: `/api/auth/login`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "username": "admin",
    "password": "admin123"
  }
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
  ```json
  {
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "token_type": "bearer",
    "user_id": 1,
    "username": "admin"
  }
  ```

#### 7. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/api/validate-frontend`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ API —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º

#### 8. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/static/{file_path}`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (JS, CSS, HTML)

---

### üîí –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω)

–≠—Ç–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`.

#### 1. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/api/auth/me`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: `Authorization: Bearer <token>`
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
  ```bash
  curl -H "Authorization: Bearer YOUR_TOKEN" \
       http://localhost:8000/api/auth/me
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
  ```json
  {
    "id": 1,
    "username": "admin",
    "email": "admin@test.com",
    "is_active": true,
    "created_at": "2025-12-14T13:33:00"
  }
  ```

#### 2. –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **–ú–µ—Ç–æ–¥**: `POST`
- **URL**: `/parse`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞ (PDF –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ)
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: `Authorization: Bearer <token>`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `file`: –§–∞–π–ª –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ (multipart/form-data)
  - `mode`: –†–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ ("fast" –∏–ª–∏ "detailed")
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
  ```bash
  curl -X POST \
       -H "Authorization: Bearer YOUR_TOKEN" \
       -F "file=@invoice.pdf" \
       -F "mode=detailed" \
       http://localhost:8000/parse
  ```

#### 3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- **–ú–µ—Ç–æ–¥**: `POST`
- **URL**: `/save`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: `Authorization: Bearer <token>`
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞**:
  ```json
  {
    "original_filename": "invoice.pdf",
    "data": {
      "header": {...},
      "items": [...]
    }
  }
  ```

#### 4. –ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–ú–µ—Ç–æ–¥**: `GET`
- **URL**: `/api/search/documents`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
- **–ó–∞–≥–æ–ª–æ–≤–∫–∏**: `Authorization: Bearer <token>`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞**:
  - `query`: –¢–µ–∫—Å—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
  - `language`: –Ø–∑—ã–∫ –ø–æ–∏—Å–∫–∞ ("simple", "russian", "english")
  - `use_ocr`: –ò—Å–∫–∞—Ç—å –≤ OCR —Ç–µ–∫—Å—Ç–µ (true/false)
  - `use_fields`: –ò—Å–∫–∞—Ç—å –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–æ–ª–µ–π (true/false)
- **–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞**:
  ```bash
  curl -H "Authorization: Bearer YOUR_TOKEN" \
       "http://localhost:8000/api/search/documents?query=test&language=simple"
  ```
- **–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞**:
  ```json
  {
    "count": 5,
    "documents": [
      {
        "id": 1,
        "status": "approved",
        "language": "ru",
        "country": "UA",
        "created_at": "2025-12-14 10:00"
      }
    ]
  }
  ```

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã?

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω
```bash
# –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
curl -X POST http://localhost:8000/api/auth/login \
     -H "Content-Type: application/json" \
     -d '{"username":"admin","password":"admin123"}'
```

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω
```bash
# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ –∑–∞–ø—Ä–æ—Å–∞—Ö
curl -H "Authorization: Bearer $TOKEN" \
     http://localhost:8000/api/auth/me
```

### –ü—Ä–∏–º–µ—Ä –≤ Python:
```python
import requests

# 1. –í—Ö–æ–¥
login_response = requests.post(
    'http://localhost:8000/api/auth/login',
    json={'username': 'admin', 'password': 'admin123'}
)
token = login_response.json()['access_token']

# 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
headers = {'Authorization': f'Bearer {token}'}
me_response = requests.get(
    'http://localhost:8000/api/auth/me',
    headers=headers
)
print(me_response.json())
```

---

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ —Ç–æ–∫–µ–Ω–∞?

–ï—Å–ª–∏ –≤—ã –ø–æ–ø—ã—Ç–∞–µ—Ç–µ—Å—å –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ –∏–ª–∏ —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º, –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

**–°—Ç–∞—Ç—É—Å**: `401 Unauthorized`

**–û—Ç–≤–µ—Ç**:
```json
{
  "detail": "Not authenticated"
}
```
–∏–ª–∏
```json
{
  "detail": "Could not validate credentials"
}
```

---

## –†–µ–∑—é–º–µ

- **–≠–Ω–¥–ø–æ–∏–Ω—Ç** = URL-–∞–¥—Ä–µ—Å –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ API
- **–ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** = –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –≤—Ö–æ–¥, health check)
- **–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã** = —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω (–ø–∞—Ä—Å–∏–Ω–≥, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, –ø–æ–∏—Å–∫)
- **–ë–µ–∑ —Ç–æ–∫–µ–Ω–∞** = –ø–æ–ª—É—á–∏—Ç–µ 401 Unauthorized

–í—Å–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–∞–ª–∏—á–∏–µ –∏ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å JWT —Ç–æ–∫–µ–Ω–∞ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∑–∞–ø—Ä–æ—Å–∞.

