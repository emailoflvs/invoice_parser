# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

## –û–ø–∏—Å–∞–Ω–∏–µ

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç –∫–æ—Ç–æ—Ä—ã–π:
1. **–ü–∞—Ä—Å–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ API** (–∫–∞–∫ –≤ –≤–µ–±-—Ñ–æ—Ä–º–µ)
2. **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ** (Playwright headless)
3. **–î–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç** –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
4. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–µ—Å—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥** (HTML, CSS computed styles, –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
5. **–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install playwright pytest-playwright

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä—ã
playwright install chromium
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
./scripts/test_frontend_visual.sh
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Python —Å–∫—Ä–∏–ø—Ç

```bash
python scripts/run_frontend_test.py
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ pytest

```bash
pytest tests/test_frontend_visual.py -v -s
```

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è

### 1. –ö–æ–ª–æ–Ω–∫–∞ "‚Ññ"
- ‚úÖ –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
- ‚úÖ –ó–∞–ø–æ–ª–Ω–µ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (1, 2, 3...)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è (–ø–µ—Ä–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞)

### 2. –ß–∏—Å–ª–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
- ‚úÖ –í—Å–µ —á–∏—Å–ª–∞ –≤–∏–¥–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é (–Ω–µ –æ–±—Ä–µ–∑–∞–Ω—ã)
- ‚úÖ `overflow: visible` –≤ CSS
- ‚úÖ `text-overflow: clip` (–Ω–µ ellipsis)
- ‚úÖ –î–ª–∏–Ω–Ω—ã–µ –∫–æ–¥—ã (–£–ö–¢ –ó–ï–î) –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é

### 3. –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
- ‚úÖ –î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (>30 —Å–∏–º–≤–æ–ª–æ–≤) –≤ textarea
- ‚úÖ –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç –≤ input

### 4. –ü–æ—Ä—è–¥–æ–∫ –∫–æ–ª–æ–Ω–æ–∫
- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç `column_order` –∏–∑ JSON
- ‚úÖ –ö–æ–ª–æ–Ω–∫–∞ "‚Ññ" –ø–µ—Ä–≤–∞—è

### 5. –°—Ç–∏–ª–∏
- ‚úÖ –ß–∏—Å–ª–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏: `min-width: max-content`
- ‚úÖ –Ø—á–µ–π–∫–∏ –Ω–µ –∏–º–µ—é—Ç `overflow: hidden`

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å:

```
/tmp/frontend_test_XXXXXX/
‚îú‚îÄ‚îÄ rendered_page.html          # –ü–æ–ª–Ω—ã–π HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã
‚îú‚îÄ‚îÄ table_data.json              # –î–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã (headers, rows)
‚îú‚îÄ‚îÄ computed_styles.json         # Computed —Å—Ç–∏–ª–∏ –≤—Å–µ—Ö —è—á–µ–µ–∫
‚îú‚îÄ‚îÄ table_screenshot.png         # –°–∫—Ä–∏–Ω—à–æ—Ç —Ç–∞–±–ª–∏—Ü—ã
‚îú‚îÄ‚îÄ detailed_table_report.json   # –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ
‚îî‚îÄ‚îÄ error_report.json            # –û—Ç—á–µ—Ç –æ–± –æ—à–∏–±–∫–∞—Ö (–µ—Å–ª–∏ –µ—Å—Ç—å)
```

## –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üöÄ –ó–∞–ø—É—Å–∫ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
======================================

üìÑ –ü–∞—Ä—Å–∏–Ω–≥ –¥–æ–∫—É–º–µ–Ω—Ç–∞: invoice.jpg
‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —É—Å–ø–µ—à–µ–Ω. Document ID: 36
üåê –û—Ç–∫—Ä—ã–≤–∞—é —Å—Ç—Ä–∞–Ω–∏—Ü—É: http://localhost:8000/?document_id=36
‚úÖ –¢–∞–±–ª–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
üíæ –°–æ—Ö—Ä–∞–Ω—è—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –≤: /tmp/frontend_test_abc123
üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: /tmp/frontend_test_abc123/table_screenshot.png

üîç –ê–Ω–∞–ª–∏–∑ —Ç–∞–±–ª–∏—Ü—ã –Ω–∞ –æ—à–∏–±–∫–∏...
   üìä –ù–∞–π–¥–µ–Ω–æ –∫–æ–ª–æ–Ω–æ–∫: 6, —Å—Ç—Ä–æ–∫: 2
   ‚úÖ –ö–æ–ª–æ–Ω–∫–∞ '‚Ññ' –Ω–∞–π–¥–µ–Ω–∞ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 0
   ‚úÖ –ö–æ–ª–æ–Ω–∫–∞ '‚Ññ' –∑–∞–ø–æ–ª–Ω–µ–Ω–∞: '1'
   üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫...
   üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫...
   ‚úÖ –î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ textarea: 67 —Å–∏–º–≤–æ–ª–æ–≤
   üìã –ü–æ—Ä—è–¥–æ–∫ –∫–æ–ª–æ–Ω–æ–∫: ['‚Ññ', '–£–ö–¢ –ó–ï–î', '–¢–æ–≤–∞—Ä', '–ö—ñ–ª—å–∫—ñ—Å—Ç—å', '–¶—ñ–Ω–∞ –±–µ–∑ –ü–î–í', '–°—É–º–∞ –±–µ–∑ –ü–î–í']
   üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª–µ–π –∫–æ–ª–æ–Ω–æ–∫...

‚úÖ –û—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ!

üìÅ –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: /tmp/frontend_test_abc123
   - rendered_page.html - –ø–æ–ª–Ω—ã–π HTML
   - table_data.json - –¥–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
   - computed_styles.json - computed —Å—Ç–∏–ª–∏
   - table_screenshot.png - —Å–∫—Ä–∏–Ω—à–æ—Ç
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `.github/workflows/test.yml`:

```yaml
- name: Frontend Visual Test
  run: |
    pip install playwright pytest-playwright
    playwright install chromium
    pytest tests/test_frontend_visual.py -v
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–°–æ–∑–¥–∞–π—Ç–µ git hook:

```bash
# .git/hooks/pre-commit
#!/bin/bash
if git diff --cached --name-only | grep -q "static/.*\.\(js\|css\)"; then
    echo "üß™ –ó–∞–ø—É—Å–∫ –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞..."
    pytest tests/test_frontend_visual.py -v
fi
```

## –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ —Ç–µ—Å—Ç –ø–∞–¥–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç**: `table_screenshot.png`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ HTML**: `rendered_page.html`
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∏–ª–∏**: `computed_styles.json`
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ**: `table_data.json`
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏**: `error_report.json`

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞

–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ —Ñ—É–Ω–∫—Ü–∏—é `analyze_table_errors()`:

```python
# –ü—Ä–∏–º–µ—Ä: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
if "8501510090" not in ukt_value:
    errors.append(f"‚ùå –£–ö–¢ –ó–ï–î –Ω–µ–ø–æ–ª–Ω—ã–π: '{ukt_value}'")
```

